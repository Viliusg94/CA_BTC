<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSTM Modelio Prognozės - Bitcoin Kainų Analizė</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <!-- Chart.js biblioteka grafikams -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome ikonėlėms -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container my-4">
        <h1 class="text-center mb-4">Bitcoin Kainų Prognozavimas su LSTM</h1>
        
        <!-- Grįžimo mygtukas -->
        <div class="mb-3">
            <a href="/" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left"></i> Grįžti į pagrindinį puslapį
            </a>
            <a href="/models" class="btn btn-outline-info ms-2">
                <i class="fas fa-brain"></i> Modelių Valdymas
            </a>
        </div>
        
        <!-- Flash pranešimai -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category if category != 'error' else 'danger' }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- Dabartinė kaina -->
        <div class="alert alert-info">
            <h3>
                Dabartinė kaina: <span id="btc-price">${{ "%.2f"|format(latest_price) }}</span>
                <!-- Kainos pokytis su ikona/rodykle -->
                {% if price_change %}
                    {% if price_change.direction == 'up' %}
                        <span class="text-success">
                            <i class="fas fa-arrow-up"></i> +{{ "%.2f"|format(price_change.percent) }}%
                        </span>
                    {% elif price_change.direction == 'down' %}
                        <span class="text-danger">
                            <i class="fas fa-arrow-down"></i> {{ "%.2f"|format(price_change.percent) }}%
                        </span>
                    {% else %}
                        <span class="text-secondary">
                            <i class="fas fa-minus"></i> {{ "%.2f"|format(price_change.percent) }}%
                        </span>
                    {% endif %}
                {% endif %}
            </h3>
            <small>Atnaujinta: <span id="price-update-time">Dabar</span></small>
        </div>
        
        <!-- Grafikas ir modelio valdymas -->
        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        Bitcoin kainos istorija ir prognozė
                    </div>
                    <div class="card-body">
                        <canvas id="price-chart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        LSTM Modelio apmokymas
                    </div>
                    <div class="card-body">
                        <p>Spauskite mygtuką, kad apmokytumėte modelį su naujausiais duomenimis.</p>
                        <!-- Pakeičiame JavaScript mygtuko veikimą į formą, kuri siunčia POST užklausą -->
                        <form action="/train_model" method="post">
                            <input type="hidden" name="model_type" value="lstm">
                            <button type="submit" class="btn btn-primary">Pradėti apmokymą</button>
                        </form>
                        <div id="training-status" class="mt-3"></div>
                    </div>
                </div>
                
                <!-- LSTM modelio informacija -->
                <div class="card mt-3">
                    <div class="card-header">
                        Apie LSTM modelį
                    </div>
                    <div class="card-body">
                        <p>LSTM (Long Short-Term Memory) yra rekurentinio neuroninio tinklo tipas, kuris gali atpažinti ir prognozuoti laiko eilučių duomenis.</p>
                        <p>Mūsų modelis yra apmokytas su istoriniais Bitcoin kainų duomenimis ir naudojamas prognozuoti būsimas kainas.</p>
                        <ul>
                            <li>Apmokymo duomenų ilgis: 30 dienų</li>
                            <li>Prognozės laikotarpis: 7 dienos</li>
                            <li>Neuronų sluoksniai: 50-100-1</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Perduodame duomenis į JavaScript -->
    <script>
        // Konvertuojame Python duomenis į JavaScript objektus
        const priceHistory = {{ price_history|tojson }};
        const predictions = {{ predictions|tojson }};
    </script>
    
    <!-- Bootstrap Bundle su Popper (reikalingas pranešimų uždarymui) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Įtraukiame savo JS failą -->
    <script src="{{ url_for('static', filename='js/predict_charts.js') }}"></script>
</body>
</html>